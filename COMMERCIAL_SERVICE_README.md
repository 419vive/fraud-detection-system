# 商業詐騙檢測API服務 - 完整解決方案

## 🎯 服務概述

本商業服務將IEEE-CIS詐騙檢測模型包裝成企業級API服務，提供完整的商業化功能，包括計費系統、API密鑰管理、使用量監控、SLA保證和客戶自助門戶。

## 🚀 核心商業功能

### 1. **計費系統** 💰
- **按次收費機制**：精確計算每次API調用成本
- **多層級定價**：免費、基礎、專業、企業四個方案
- **實時計費**：即時成本計算和月度預估
- **自動發票生成**：月度賬單和使用明細

### 2. **API密鑰管理** 🔑
- **安全密鑰生成**：加密哈希存儲，防止洩漏
- **權限控制**：細粒度權限管理（讀取、預測、批量、管理）
- **速率限制**：根據訂閱方案自動調整速率限制
- **IP白名單**：增強安全性的IP訪問控制

### 3. **使用量監控** 📊
- **實時追蹤**：API調用次數、響應時間、錯誤率
- **智能緩存**：高效的使用數據緩存和批處理
- **成本警報**：預算超支自動通知
- **詳細分析**：按服務類型、時間段的使用分析

### 4. **SLA保證** 🎯
- **99.9%正常運行時間**：企業級可用性保證
- **自動健康檢查**：多端點服務監控
- **事件管理**：自動事件創建和解決
- **信用補償**：SLA違約自動計算補償金額

### 5. **客戶門戶** 🏠
- **自助服務**：密鑰管理、使用量查看、計費信息
- **實時儀表板**：性能指標、成本分析、警報狀態
- **帳戶管理**：方案升級、安全設定、通知配置
- **支援中心**：文檔、FAQ、技術支援

## 📋 定價方案

| 方案 | 月費 | 包含預測 | 速率限制 | 特色功能 |
|------|------|----------|----------|----------|
| **免費** | $0 | 1,000次 | 10/分鐘 | 基礎詐騙檢測、API訪問 |
| **基礎** | $99 | 10,000次 | 100/分鐘 | 進階檢測、批量處理、基礎監控 |
| **專業** | $299 | 50,000次 | 500/分鐘 | 實時監控、漂移檢測、自定義模型 |
| **企業** | $999 | 200,000次 | 2,000/分鐘 | 24/7監控、SLA保證、專屬支援 |

### 超額計費
- 免費方案：$0.01/次
- 基礎方案：$0.008/次（1-10K），$0.005/次（10K+）
- 專業方案：$0.006/次（1-25K），$0.004/次（25K-100K），$0.002/次（100K+）
- 企業方案：$0.003/次（1-100K），$0.002/次（100K-500K），$0.001/次（500K+）

## 🛠️ 快速部署

### 安裝依賴

```bash
pip install fastapi uvicorn streamlit plotly pandas numpy scikit-learn
pip install redis sqlite3 psutil requests aiohttp
pip install pydantic python-jose cryptography
```

### 啟動服務

```bash
# 啟動完整商業服務（API + 客戶門戶）
python run_commercial_service.py --service all

# 僅啟動API服務
python run_commercial_service.py --service api --api-port 8000

# 僅啟動客戶門戶
python run_commercial_service.py --service portal --portal-port 8501
```

### 服務地址

- **API服務**: http://localhost:8000
- **API文檔**: http://localhost:8000/docs
- **客戶門戶**: http://localhost:8501

## 📡 API使用指南

### 1. 獲取API密鑰

在客戶門戶註冊帳戶並創建API密鑰，或使用演示帳戶：
- 演示帳號：`demo@example.com`
- 演示密碼：`demo123`

### 2. API認證

所有API請求需要在Header中包含Bearer Token：

```bash
curl -H "Authorization: Bearer your_api_key_here" \
     -H "Content-Type: application/json" \
     http://localhost:8000/predict
```

### 3. 單筆預測

```python
import requests

headers = {
    "Authorization": "Bearer your_api_key_here",
    "Content-Type": "application/json"
}

data = {
    "transaction_data": {
        "TransactionAmt": 150.0,
        "ProductCD": "W",
        "card1": 1234,
        "card2": 567,
        "card3": 150,
        "addr1": 123,
        "addr2": 456
    },
    "model_version": "v1"
}

response = requests.post(
    "http://localhost:8000/predict",
    headers=headers,
    json=data
)

result = response.json()
print(f"詐騙概率: {result['fraud_probability']:.2%}")
```

### 4. 批量預測

```python
batch_data = {
    "transactions": [
        {"TransactionAmt": 150.0, "ProductCD": "W", "card1": 1234},
        {"TransactionAmt": 75.0, "ProductCD": "C", "card1": 5678},
        # ... 更多交易
    ],
    "model_version": "v1"
}

response = requests.post(
    "http://localhost:8000/predict/batch",
    headers=headers,
    json=batch_data
)
```

### 5. 查看使用統計

```python
response = requests.get(
    "http://localhost:8000/account/usage",
    headers=headers
)

usage_stats = response.json()
print(f"本月請求數: {usage_stats['total_requests']:,}")
print(f"成功率: {usage_stats['success_rate']:.1f}%")
```

## 🔧 系統架構

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   客戶門戶       │    │   API網關        │    │   詐騙檢測引擎   │
│  (Streamlit)    │    │  (FastAPI)      │    │  (ML Models)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   用戶管理       │    │   API密鑰管理    │    │   預測服務       │
│                 │    │   認證&授權      │    │   模型推理       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   計費系統       │    │   使用量監控     │    │   SLA管理        │
│   實時計費       │    │   實時追蹤       │    │   健康檢查       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 ▼
                    ┌─────────────────┐
                    │   SQLite資料庫   │
                    │   Redis緩存      │
                    └─────────────────┘
```

## 📊 監控和分析

### 系統監控指標

- **正常運行時間**: 目標99.9%，實時監控
- **響應時間**: P50 < 200ms, P95 < 500ms
- **錯誤率**: < 1%
- **吞吐量**: 支援高併發請求

### 業務指標

- **API調用量**: 按客戶、時間段統計
- **收入追蹤**: 實時收入和預估
- **客戶分析**: 使用模式和增長趨勢
- **成本分析**: 基礎設施成本和利潤率

### 警報系統

- **使用量警報**: 預算80%、100%提醒
- **系統警報**: 服務異常、高錯誤率
- **SLA警報**: 可用性低於閾值
- **安全警報**: 異常API使用模式

## 🔒 安全特性

### API安全

- **密鑰加密**: SHA-256哈希存儲
- **HTTPS強制**: 所有API調用加密傳輸
- **速率限制**: 防止API濫用
- **IP白名單**: 限制訪問來源

### 數據安全

- **數據加密**: 敏感數據加密存儲
- **審計日誌**: 完整的操作記錄
- **權限控制**: 最小權限原則
- **定期備份**: 數據安全保障

## 📈 擴展和優化

### 水平擴展

- **負載均衡**: 多實例部署
- **資料庫分片**: 高併發支援
- **緩存層**: Redis集群
- **CDN加速**: 全球分發

### 性能優化

- **模型優化**: 推理加速
- **批處理**: 提高吞吐量
- **異步處理**: 非阻塞操作
- **連接池**: 資料庫連接優化

## 🎯 商業價值

### 技術價值

- **企業級可靠性**: 99.9%正常運行時間
- **高性能**: 毫秒級響應時間
- **可擴展**: 支援大規模併發
- **易集成**: RESTful API標準

### 商業價值

- **立即變現**: 按使用量付費模式
- **客戶自助**: 降低運營成本
- **透明計費**: 增加客戶信任
- **SLA保證**: 企業級服務承諾

### 市場優勢

- **技術領先**: 先進的ML算法
- **服務完整**: 端到端解決方案
- **定價靈活**: 適合各種規模客戶
- **支援完善**: 多渠道技術支援

## 🔮 未來規劃

### 短期目標（1-3個月）

- **支付集成**: Stripe、PayPal支付
- **多租戶**: 企業級多租戶架構
- **API版本**: 向後兼容的版本管理
- **監控增強**: Prometheus + Grafana

### 中期目標（3-6個月）

- **AI增強**: 自動模型優化
- **多區域**: 全球部署和CDN
- **企業集成**: SSO、LDAP支援
- **高級分析**: BI儀表板和報告

### 長期目標（6-12個月）

- **市場拓展**: 多行業適配
- **生態系統**: 合作夥伴API
- **智能運維**: AIOps自動化
- **國際化**: 多語言和多幣種

## 📞 技術支援

### 社區支援
- **文檔**: 完整的API文檔和教程
- **示例**: 多語言SDK和示例代碼
- **FAQ**: 常見問題解答

### 商業支援
- **基礎方案**: 電子郵件支援（48小時響應）
- **專業方案**: 優先支援（24小時響應）
- **企業方案**: 專屬客戶經理（4小時響應）

### 聯繫方式
- **技術問題**: tech-support@fraud-detection-api.com
- **商業合作**: business@fraud-detection-api.com
- **緊急支援**: +1-800-FRAUD-API

---

**詐騙檢測API - 讓AI防護您的業務安全** 🛡️